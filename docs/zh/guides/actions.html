<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>动作 Actions | XState 文档</title>
    <meta name="generator" content="VuePress 1.8.2">
    <script src="https://plausible.io/js/plausible.js" defer="defer"></script>
    <meta name="description" content="XState 文档：现代 Web 的状态机和状态图">
    
    <link rel="preload" href="/docs/assets/css/0.styles.2b0aa556.css" as="style"><link rel="preload" href="/docs/assets/js/app.9ff62a46.js" as="script"><link rel="preload" href="/docs/assets/js/3.2a139785.js" as="script"><link rel="preload" href="/docs/assets/js/9.47fde1b3.js" as="script"><link rel="preload" href="/docs/assets/js/94.4ee7fb06.js" as="script"><link rel="preload" href="/docs/assets/js/10.f0e23b4a.js" as="script"><link rel="prefetch" href="/docs/assets/js/100.d7c7203b.js"><link rel="prefetch" href="/docs/assets/js/101.e5651eb9.js"><link rel="prefetch" href="/docs/assets/js/102.98356cdf.js"><link rel="prefetch" href="/docs/assets/js/103.cc2de6ee.js"><link rel="prefetch" href="/docs/assets/js/104.062ebd1f.js"><link rel="prefetch" href="/docs/assets/js/105.b11a4457.js"><link rel="prefetch" href="/docs/assets/js/106.1c0df1a6.js"><link rel="prefetch" href="/docs/assets/js/107.8ac2fd75.js"><link rel="prefetch" href="/docs/assets/js/108.45131a20.js"><link rel="prefetch" href="/docs/assets/js/109.6af6767a.js"><link rel="prefetch" href="/docs/assets/js/11.6b22e883.js"><link rel="prefetch" href="/docs/assets/js/110.a4e20056.js"><link rel="prefetch" href="/docs/assets/js/111.06209a4f.js"><link rel="prefetch" href="/docs/assets/js/112.243301d1.js"><link rel="prefetch" href="/docs/assets/js/113.2406b495.js"><link rel="prefetch" href="/docs/assets/js/114.02246112.js"><link rel="prefetch" href="/docs/assets/js/115.0034e44c.js"><link rel="prefetch" href="/docs/assets/js/116.fa4c57a3.js"><link rel="prefetch" href="/docs/assets/js/117.24211f2d.js"><link rel="prefetch" href="/docs/assets/js/118.0e0898a6.js"><link rel="prefetch" href="/docs/assets/js/119.d5d3fc5f.js"><link rel="prefetch" href="/docs/assets/js/12.fd10705f.js"><link rel="prefetch" href="/docs/assets/js/120.e5e48fe1.js"><link rel="prefetch" href="/docs/assets/js/121.08e7b817.js"><link rel="prefetch" href="/docs/assets/js/122.85f942e1.js"><link rel="prefetch" href="/docs/assets/js/123.c65b6016.js"><link rel="prefetch" href="/docs/assets/js/124.e207b57e.js"><link rel="prefetch" href="/docs/assets/js/125.5e41c1f7.js"><link rel="prefetch" href="/docs/assets/js/126.d254bc34.js"><link rel="prefetch" href="/docs/assets/js/127.5ae4940c.js"><link rel="prefetch" href="/docs/assets/js/128.c72fba74.js"><link rel="prefetch" href="/docs/assets/js/129.81dc5ce5.js"><link rel="prefetch" href="/docs/assets/js/13.7fc80339.js"><link rel="prefetch" href="/docs/assets/js/130.7243940a.js"><link rel="prefetch" href="/docs/assets/js/131.d31e6dce.js"><link rel="prefetch" href="/docs/assets/js/132.89b49ed2.js"><link rel="prefetch" href="/docs/assets/js/133.6f39e702.js"><link rel="prefetch" href="/docs/assets/js/134.f7f5e2db.js"><link rel="prefetch" href="/docs/assets/js/135.993c1fee.js"><link rel="prefetch" href="/docs/assets/js/136.f02e80f8.js"><link rel="prefetch" href="/docs/assets/js/137.20a1d647.js"><link rel="prefetch" href="/docs/assets/js/138.2df47954.js"><link rel="prefetch" href="/docs/assets/js/139.ece133a0.js"><link rel="prefetch" href="/docs/assets/js/14.8ce1a4ab.js"><link rel="prefetch" href="/docs/assets/js/140.a0346aeb.js"><link rel="prefetch" href="/docs/assets/js/141.08b34bbb.js"><link rel="prefetch" href="/docs/assets/js/142.d2152a86.js"><link rel="prefetch" href="/docs/assets/js/143.4069e72a.js"><link rel="prefetch" href="/docs/assets/js/144.cbf342b5.js"><link rel="prefetch" href="/docs/assets/js/145.a438f1ad.js"><link rel="prefetch" href="/docs/assets/js/146.13f6e354.js"><link rel="prefetch" href="/docs/assets/js/147.feabdd9c.js"><link rel="prefetch" href="/docs/assets/js/148.d42e19a1.js"><link rel="prefetch" href="/docs/assets/js/149.17b1ef2e.js"><link rel="prefetch" href="/docs/assets/js/15.550b3285.js"><link rel="prefetch" href="/docs/assets/js/150.a61a1af5.js"><link rel="prefetch" href="/docs/assets/js/16.8936abf7.js"><link rel="prefetch" href="/docs/assets/js/17.a4908fe2.js"><link rel="prefetch" href="/docs/assets/js/18.37fffc44.js"><link rel="prefetch" href="/docs/assets/js/19.a6deb435.js"><link rel="prefetch" href="/docs/assets/js/20.d96278bf.js"><link rel="prefetch" href="/docs/assets/js/21.259fca35.js"><link rel="prefetch" href="/docs/assets/js/22.47f14661.js"><link rel="prefetch" href="/docs/assets/js/23.06275862.js"><link rel="prefetch" href="/docs/assets/js/24.2007e95c.js"><link rel="prefetch" href="/docs/assets/js/25.4874f911.js"><link rel="prefetch" href="/docs/assets/js/26.10a5cef1.js"><link rel="prefetch" href="/docs/assets/js/27.68f412bc.js"><link rel="prefetch" href="/docs/assets/js/28.40348427.js"><link rel="prefetch" href="/docs/assets/js/29.a9ff469f.js"><link rel="prefetch" href="/docs/assets/js/30.c30d25c6.js"><link rel="prefetch" href="/docs/assets/js/31.b87c4e17.js"><link rel="prefetch" href="/docs/assets/js/32.036c2a71.js"><link rel="prefetch" href="/docs/assets/js/33.87428c4c.js"><link rel="prefetch" href="/docs/assets/js/34.9fb52f7e.js"><link rel="prefetch" href="/docs/assets/js/35.671fc86b.js"><link rel="prefetch" href="/docs/assets/js/36.afbcda4c.js"><link rel="prefetch" href="/docs/assets/js/37.004aee44.js"><link rel="prefetch" href="/docs/assets/js/38.c9c0a307.js"><link rel="prefetch" href="/docs/assets/js/39.8316996b.js"><link rel="prefetch" href="/docs/assets/js/4.833869ae.js"><link rel="prefetch" href="/docs/assets/js/40.68778e57.js"><link rel="prefetch" href="/docs/assets/js/41.7515ed5a.js"><link rel="prefetch" href="/docs/assets/js/42.6b841429.js"><link rel="prefetch" href="/docs/assets/js/43.e091e244.js"><link rel="prefetch" href="/docs/assets/js/44.2837bc31.js"><link rel="prefetch" href="/docs/assets/js/45.5763291b.js"><link rel="prefetch" href="/docs/assets/js/46.e510f06c.js"><link rel="prefetch" href="/docs/assets/js/47.14def85c.js"><link rel="prefetch" href="/docs/assets/js/48.8d28ebcb.js"><link rel="prefetch" href="/docs/assets/js/49.b3369b36.js"><link rel="prefetch" href="/docs/assets/js/5.ffe2259d.js"><link rel="prefetch" href="/docs/assets/js/50.300e8022.js"><link rel="prefetch" href="/docs/assets/js/51.ececfe07.js"><link rel="prefetch" href="/docs/assets/js/52.60275a65.js"><link rel="prefetch" href="/docs/assets/js/53.1d0c50da.js"><link rel="prefetch" href="/docs/assets/js/54.af61eba7.js"><link rel="prefetch" href="/docs/assets/js/55.7a77adec.js"><link rel="prefetch" href="/docs/assets/js/56.15dfc3a7.js"><link rel="prefetch" href="/docs/assets/js/57.9000b49f.js"><link rel="prefetch" href="/docs/assets/js/58.71213737.js"><link rel="prefetch" href="/docs/assets/js/59.6dc2899c.js"><link rel="prefetch" href="/docs/assets/js/6.bafab845.js"><link rel="prefetch" href="/docs/assets/js/60.3c8df665.js"><link rel="prefetch" href="/docs/assets/js/61.2cf7a697.js"><link rel="prefetch" href="/docs/assets/js/62.3b0dceb6.js"><link rel="prefetch" href="/docs/assets/js/63.04baf8e2.js"><link rel="prefetch" href="/docs/assets/js/64.605fce1f.js"><link rel="prefetch" href="/docs/assets/js/65.e44fd703.js"><link rel="prefetch" href="/docs/assets/js/66.40fdc80b.js"><link rel="prefetch" href="/docs/assets/js/67.8c5450dc.js"><link rel="prefetch" href="/docs/assets/js/68.65004e60.js"><link rel="prefetch" href="/docs/assets/js/69.c0f72cbb.js"><link rel="prefetch" href="/docs/assets/js/7.04fa22c5.js"><link rel="prefetch" href="/docs/assets/js/70.d0bd9e52.js"><link rel="prefetch" href="/docs/assets/js/71.0960f284.js"><link rel="prefetch" href="/docs/assets/js/72.15d435bc.js"><link rel="prefetch" href="/docs/assets/js/73.c314e153.js"><link rel="prefetch" href="/docs/assets/js/74.73d4f8c0.js"><link rel="prefetch" href="/docs/assets/js/75.ee37cc7b.js"><link rel="prefetch" href="/docs/assets/js/76.8b0d2020.js"><link rel="prefetch" href="/docs/assets/js/77.0f2e9723.js"><link rel="prefetch" href="/docs/assets/js/78.39e1119f.js"><link rel="prefetch" href="/docs/assets/js/79.ab27be36.js"><link rel="prefetch" href="/docs/assets/js/8.1b04bf18.js"><link rel="prefetch" href="/docs/assets/js/80.900bd3a7.js"><link rel="prefetch" href="/docs/assets/js/81.d2c445d1.js"><link rel="prefetch" href="/docs/assets/js/82.3ecee5a4.js"><link rel="prefetch" href="/docs/assets/js/83.5817b711.js"><link rel="prefetch" href="/docs/assets/js/84.0362d622.js"><link rel="prefetch" href="/docs/assets/js/85.632fbe9a.js"><link rel="prefetch" href="/docs/assets/js/86.662c17b5.js"><link rel="prefetch" href="/docs/assets/js/87.c13f0fd5.js"><link rel="prefetch" href="/docs/assets/js/88.2fc1f800.js"><link rel="prefetch" href="/docs/assets/js/89.2f40245c.js"><link rel="prefetch" href="/docs/assets/js/90.c968db95.js"><link rel="prefetch" href="/docs/assets/js/91.0e61d4df.js"><link rel="prefetch" href="/docs/assets/js/92.4db22cd6.js"><link rel="prefetch" href="/docs/assets/js/93.3b151b01.js"><link rel="prefetch" href="/docs/assets/js/95.e59db559.js"><link rel="prefetch" href="/docs/assets/js/96.dbf30589.js"><link rel="prefetch" href="/docs/assets/js/97.383d0989.js"><link rel="prefetch" href="/docs/assets/js/98.57800ba3.js"><link rel="prefetch" href="/docs/assets/js/99.b37e1fa6.js"><link rel="prefetch" href="/docs/assets/js/vendors~docsearch.6f0f340d.js">
    <link rel="stylesheet" href="/docs/assets/css/0.styles.2b0aa556.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/docs/zh/" class="home-link router-link-active"><img src="/docs/logo.svg" alt="XState 文档" class="logo"> <span class="site-name can-hide">XState 文档</span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://paka.dev/npm/xstate/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  API
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://stately.ai/viz" target="_blank" rel="noopener noreferrer" class="nav-link external">
  可视化工具
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://discord.gg/xtWgFTgvNV" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Discord
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://github.com/statelyai/xstate/discussions" target="_blank" rel="noopener noreferrer" class="nav-link external">
  社区
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">选择语言</span> <span class="arrow down"></span></button> <button type="button" aria-label="Select language" class="mobile-dropdown-title"><span class="title">选择语言</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs/guides/actions.html" class="nav-link">
  English
</a></li><li class="dropdown-item"><!----> <a href="/docs/zh/guides/actions.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  简体中文
</a></li></ul></div></div> <a href="https://github.com/davidkpiano/xstate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://paka.dev/npm/xstate/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  API
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://stately.ai/viz" target="_blank" rel="noopener noreferrer" class="nav-link external">
  可视化工具
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://discord.gg/xtWgFTgvNV" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Discord
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://github.com/statelyai/xstate/discussions" target="_blank" rel="noopener noreferrer" class="nav-link external">
  社区
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">选择语言</span> <span class="arrow down"></span></button> <button type="button" aria-label="Select language" class="mobile-dropdown-title"><span class="title">选择语言</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs/guides/actions.html" class="nav-link">
  English
</a></li><li class="dropdown-item"><!----> <a href="/docs/zh/guides/actions.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  简体中文
</a></li></ul></div></div> <a href="https://github.com/davidkpiano/xstate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>什么是 XState?</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>关于</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>向导</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/docs/zh/guides/start.html" class="sidebar-link">入门</a></li><li><a href="/docs/zh/guides/installation.html" class="sidebar-link">安装</a></li><li><a href="/docs/zh/guides/introduction-to-state-machines-and-statecharts/" class="sidebar-link">状态机和状态图简介</a></li><li><a href="/docs/zh/guides/machines.html" class="sidebar-link">状态机 Machines</a></li><li><a href="/docs/zh/guides/states.html" class="sidebar-link">状态 State</a></li><li><a href="/docs/zh/guides/statenodes.html" class="sidebar-link">状态节点</a></li><li><a href="/docs/zh/guides/events.html" class="sidebar-link">事件 Event</a></li><li><a href="/docs/zh/guides/transitions.html" class="sidebar-link">转换 Transitions</a></li><li><a href="/docs/zh/guides/hierarchical.html" class="sidebar-link">分层状态节点 Hierarchical State Node</a></li><li><a href="/docs/zh/guides/parallel.html" class="sidebar-link">并行状态节点 Parallel State Node</a></li><li><a href="/docs/zh/guides/final.html" class="sidebar-link">最终状态</a></li><li><a href="/docs/zh/guides/effects.html" class="sidebar-link">作用 Effects</a></li><li><a href="/docs/zh/guides/actions.html" aria-current="page" class="active sidebar-link">动作 Actions</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/zh/guides/actions.html#api" class="sidebar-link">API</a></li><li class="sidebar-sub-header"><a href="/docs/zh/guides/actions.html#声明动作" class="sidebar-link">声明动作</a></li><li class="sidebar-sub-header"><a href="/docs/zh/guides/actions.html#动作顺序" class="sidebar-link">动作顺序</a></li><li class="sidebar-sub-header"><a href="/docs/zh/guides/actions.html#发送动作-send-action" class="sidebar-link">发送动作（send action）</a></li><li class="sidebar-sub-header"><a href="/docs/zh/guides/actions.html#升高动作-raise-action" class="sidebar-link">升高动作（raise action）</a></li><li class="sidebar-sub-header"><a href="/docs/zh/guides/actions.html#响应动作-respond-action" class="sidebar-link">响应动作 （respond action）</a></li><li class="sidebar-sub-header"><a href="/docs/zh/guides/actions.html#转发动作-forwardto-action" class="sidebar-link">转发动作（forwardTo action）</a></li><li class="sidebar-sub-header"><a href="/docs/zh/guides/actions.html#错误升级动作-escalate-action" class="sidebar-link">错误升级动作（escalate action）</a></li><li class="sidebar-sub-header"><a href="/docs/zh/guides/actions.html#日志动作-log-action" class="sidebar-link">日志动作（log action）</a></li><li class="sidebar-sub-header"><a href="/docs/zh/guides/actions.html#选择动作-choose-action" class="sidebar-link">选择动作（choose action）</a></li><li class="sidebar-sub-header"><a href="/docs/zh/guides/actions.html#纯动作-pure-action" class="sidebar-link">纯动作（pure action）</a></li><li class="sidebar-sub-header"><a href="/docs/zh/guides/actions.html#自转换动作" class="sidebar-link">自转换动作</a></li></ul></li><li><a href="/docs/zh/guides/guards.html" class="sidebar-link">守卫（Guarded）转换</a></li><li><a href="/docs/zh/guides/context.html" class="sidebar-link">上下文 Context</a></li><li><a href="/docs/zh/guides/models.html" class="sidebar-link">模型 Models</a></li><li><a href="/docs/zh/guides/activities.html" class="sidebar-link">活动 Activities</a></li><li><a href="/docs/zh/guides/communication.html" class="sidebar-link">调用 Services</a></li><li><a href="/docs/zh/guides/actors.html" class="sidebar-link">演员 Actors</a></li><li><a href="/docs/zh/guides/delays.html" class="sidebar-link">延迟事件 和 转换</a></li><li><a href="/docs/zh/guides/history.html" class="sidebar-link">历史 History</a></li><li><a href="/docs/zh/guides/ids.html" class="sidebar-link">标识 State 节点</a></li><li><a href="/docs/zh/guides/interpretation.html" class="sidebar-link">解释（Interpreting） 状态机</a></li><li><a href="/docs/zh/guides/testing.html" class="sidebar-link">测试状态机</a></li><li><a href="/docs/zh/guides/typescript.html" class="sidebar-link">使用 TypeScript</a></li><li><a href="/docs/zh/guides/scxml.html" class="sidebar-link">SCXML</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>教程</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>配方</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>包</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>模式</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>示例</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>新闻和有用地址</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="动作-actions"><a href="#动作-actions" class="header-anchor">#</a> 动作 Actions</h1> <p>动作，是即发即弃的 <a href="/docs/zh/guides/effects.html">作用</a>。 它们可以通过三种方式声明：</p> <ul><li><code>entry</code> 动作，进入状态时执行</li> <li><code>exit</code> 动作，退出状态时执行</li> <li>执行转换时，执行转换的动作</li></ul> <p>要了解更多信息，请阅读 <a href="/docs/zh/guides/introduction-to-state-machines-and-statecharts/#actions">状态图简介中的动作</a>。</p> <h2 id="api"><a href="#api" class="header-anchor">#</a> API</h2> <p>可以像这样添加动作</p> <div class="language-js extra-class"><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div><br><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><br><br><br><br><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><br><br><br></div><pre class="language-js"><code><span class="token keyword">const</span> triggerMachine <span class="token operator">=</span> <span class="token function">createMachine</span><span class="token punctuation">(</span>
  <span class="token punctuation">{</span>
    id<span class="token operator">:</span> <span class="token string">'trigger'</span><span class="token punctuation">,</span>
    initial<span class="token operator">:</span> <span class="token string">'inactive'</span><span class="token punctuation">,</span>
    states<span class="token operator">:</span> <span class="token punctuation">{</span>
      inactive<span class="token operator">:</span> <span class="token punctuation">{</span>
        on<span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token constant">TRIGGER</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            target<span class="token operator">:</span> <span class="token string">'active'</span><span class="token punctuation">,</span>
            <span class="token comment">// 转换 actions</span>
            actions<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'activate'</span><span class="token punctuation">,</span> <span class="token string">'sendTelemetry'</span><span class="token punctuation">]</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      active<span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token comment">// 进入 actions</span>
        entry<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'notifyActive'</span><span class="token punctuation">,</span> <span class="token string">'sendTelemetry'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token comment">// 退出 actions</span>
        exit<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'notifyInactive'</span><span class="token punctuation">,</span> <span class="token string">'sendTelemetry'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        on<span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token constant">STOP</span><span class="token operator">:</span> <span class="token punctuation">{</span> target<span class="token operator">:</span> <span class="token string">'inactive'</span> <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    actions<span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token comment">// action 实现</span>
      <span class="token function-variable function">activate</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">context<span class="token punctuation">,</span> event</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'activating...'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token function-variable function">notifyActive</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">context<span class="token punctuation">,</span> event</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'active!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token function-variable function">notifyInactive</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">context<span class="token punctuation">,</span> event</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'inactive!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token function-variable function">sendTelemetry</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">context<span class="token punctuation">,</span> event</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'time:'</span><span class="token punctuation">,</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><details><summary>
    什么时候应该使用 转换 VS entry/exit 动作？
  </summary> <p>这取决于！ 它们的做的事不同：</p> <ul><li>entry/exit 操作，意味着“在进入/退出此状态的任何转换上 <strong>执行此 动作</strong>”。 当 动作 只依赖于它所在的状态节点，而不依赖于上一个/下一个状态节点 或 事件时，使用进入/退出 动作</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// ...</span>
<span class="token punctuation">{</span>
  idle<span class="token operator">:</span> <span class="token punctuation">{</span>
    on<span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token constant">LOAD</span><span class="token operator">:</span> <span class="token string">'loading'</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  loading<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// 每当进入“loading”状态时执行此 动作</span>
    entry<span class="token operator">:</span> <span class="token string">'fetchData'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// ...</span>
</code></pre></div><ul><li>转换 动作 意味着“仅在此转换上 <strong>执行此 动作</strong>”。 当 动作 依赖于事件和它当前所处的状态节点时，使用转换 动作。</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// ...</span>
<span class="token punctuation">{</span>
  idle<span class="token operator">:</span> <span class="token punctuation">{</span>
    on<span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token constant">LOAD</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        target<span class="token operator">:</span> <span class="token string">'loading'</span><span class="token punctuation">,</span>
        <span class="token comment">// 此 动作 仅在此转换时执行</span>
        actions<span class="token operator">:</span> <span class="token string">'fetchData'</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  loading<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// ...</span>
</code></pre></div></details> <div class="custom-block tip"><p class="custom-block-title">提示</p> <p>可以通过直接在状态机配置中指定 动作 函数来快速原型化 动作 实现：</p> <div class="language-js extra-class"><div class="highlight-lines"><br><br><br><div class="highlighted"> </div><br><br><br></div><pre class="language-js"><code><span class="token comment">// ...</span>
<span class="token constant">TRIGGER</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  target<span class="token operator">:</span> <span class="token string">'active'</span><span class="token punctuation">,</span>
  <span class="token function-variable function">actions</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">context<span class="token punctuation">,</span> event</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'activating...'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// ...</span>
</code></pre></div><p>在状态机选项的 <code>actions</code> 属性中重构内联 动作 实现，可以更容易地调试、序列化、测试和准确地可视化 动作。</p></div> <h2 id="声明动作"><a href="#声明动作" class="header-anchor">#</a> 声明动作</h2> <p>从 <code>machine.transition(...)</code> 返回的 <code>State</code> 实例有一个 <code>.actions</code> 属性，它是一个供 解释（interpret） 执行的 动作 对象数组：</p> <div class="language-js extra-class"><div class="highlight-lines"><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><br></div><pre class="language-js"><code><span class="token keyword">const</span> activeState <span class="token operator">=</span> triggerMachine<span class="token punctuation">.</span><span class="token function">transition</span><span class="token punctuation">(</span><span class="token string">'inactive'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> type<span class="token operator">:</span> <span class="token string">'TRIGGER'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>activeState<span class="token punctuation">.</span>actions<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// [</span>
<span class="token comment">//   { type: 'activate', exec: ... },</span>
<span class="token comment">//   { type: 'sendTelemetry', exec: ... },</span>
<span class="token comment">//   { type: 'notifyActive', exec: ... },</span>
<span class="token comment">//   { type: 'sendTelemetry', exec: ... }</span>
<span class="token comment">// ]</span>
</code></pre></div><p>每个 动作 对象都有两个属性（以及其他可以指定的属性）：</p> <ul><li><code>type</code> - 动作 类型</li> <li><code>exec</code> - 动作 执行函数</li></ul> <p><code>exec</code> 函数有 3 个参数：</p> <table><thead><tr><th>参数</th> <th>类型</th> <th>描述</th></tr></thead> <tbody><tr><td><code>context</code></td> <td>TContext</td> <td>当前状态机的上下文</td></tr> <tr><td><code>event</code></td> <td>event object</td> <td>导致转换的事件</td></tr> <tr><td><code>actionMeta</code></td> <td>meta object</td> <td>包含有关 动作 的元数据的对象（见下文）</td></tr></tbody></table> <p><code>actionMeta</code> 对象包括以下属性：</p> <table><thead><tr><th>参数</th> <th>类型</th> <th>描述</th></tr></thead> <tbody><tr><td><code>action</code></td> <td>action object</td> <td>原始 动作 对象</td></tr> <tr><td><code>state</code></td> <td>State</td> <td>转换后的已解析的状态机状态</td></tr></tbody></table> <p>解释（interpret）将调用带有 <code>currentState.context</code>、<code>event</code> 和状态机转换到的 <code>state</code> 的 <code>exec</code> 函数。 你可以自定义此 动作。 阅读 <a href="/docs/zh/guides/interpretation.html#executing-actions">执行 动作</a> 了解更多详情。</p> <h2 id="动作顺序"><a href="#动作顺序" class="header-anchor">#</a> 动作顺序</h2> <p>在执行状态图时，动作的顺序不一定重要（也就是说，它们不应该相互依赖）。 但是，<code>state.actions</code> 数组中的操作顺序是：</p> <ol><li><code>exit</code> 动作 - 退出状态节点的所有退出 动作，从原子状态节点开始</li> <li>转换 <code>actions</code> - 在所选转换上定义的所有 动作</li> <li><code>entry</code> 动作 - 进入状态节点的所有进入 动作，从父状态开始</li></ol> <div class="custom-block warning"><p class="custom-block-title">注意</p> <p>在 XState 4.x 版中，<code>assign</code> 动作 具有优先权，并且在任何其他 动作 之前执行。 此行为将在第 5 版中修复，因为将按顺序调用 <code>assign</code> 操作。</p></div> <div class="custom-block danger"><p class="custom-block-title">警告</p> <p>此处记录的所有 动作 创建者都返回 <strong>动作 对象</strong>； 它是一个纯函数，它只返回一个 动作 对象，并 <em>不是</em> 命令式的发送一个事件。 不要命令式的调用 动作 创建者； 因为 他们什么都不会做！</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 🚫 不要这样做！</span>
<span class="token function-variable function">entry</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// 🚫 这将什么也不做； send() 不是命令式函数！</span>
  <span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">{</span> type<span class="token operator">:</span> <span class="token string">'SOME_EVENT'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">{</span> type<span class="token operator">:</span> <span class="token string">'SOME_EVENT'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// =&gt; { type: 'xstate.send', event: { type: 'SOME_EVENT' } }</span>

<span class="token comment">// ✅ 这样替换</span>
entry<span class="token operator">:</span> <span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">{</span> type<span class="token operator">:</span> <span class="token string">'SOME_EVENT'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></div> <h2 id="发送动作-send-action"><a href="#发送动作-send-action" class="header-anchor">#</a> 发送动作（send action）</h2> <p><code>send(event)</code> 动作 创建者创建了一个特殊的“发送” 动作 对象，它告诉服务（即，<a href="/docs/zh/guides/interpretation.html">解释（interpret） 状态机</a>）将该事件发送给它自己。 它在外部事件队列中，将一个事件排入正在运行的服务中，这意味着该事件将在 解释（interpret） 的下一步“步骤”上发送。</p> <table><thead><tr><th>参数</th> <th>类型</th> <th>描述</th></tr></thead> <tbody><tr><td><code>event</code></td> <td>string or event object or event expression</td> <td>发送到指定<code>options.to</code>（或 self）的事件</td></tr> <tr><td><code>options?</code></td> <td>send options (见下文)</td> <td>发送事件的选项。</td></tr></tbody></table> <p>send <code>options</code> 参数是一个包含以下内容的对象：</p> <table><thead><tr><th>参数</th> <th>类型</th> <th>描述</th></tr></thead> <tbody><tr><td><code>id?</code></td> <td>string</td> <td>send ID (用于取消)</td></tr> <tr><td><code>to?</code></td> <td>string</td> <td>事件的目标（默认为 self）</td></tr> <tr><td><code>delay?</code></td> <td>number</td> <td>发送事件前的超时时间（毫秒），如果在超时前没有取消事件</td></tr></tbody></table> <div class="custom-block warning"><p class="custom-block-title">注意</p> <p><code>send(...)</code> 函数是一个 <strong>动作 创建者</strong>； 它是一个纯函数，它只返回一个 动作 对象，并 <em>不会</em> 命令式地发送一个事件。</p></div> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> createMachine<span class="token punctuation">,</span> send <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'xstate'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> lazyStubbornMachine <span class="token operator">=</span> <span class="token function">createMachine</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  id<span class="token operator">:</span> <span class="token string">'stubborn'</span><span class="token punctuation">,</span>
  initial<span class="token operator">:</span> <span class="token string">'inactive'</span><span class="token punctuation">,</span>
  states<span class="token operator">:</span> <span class="token punctuation">{</span>
    inactive<span class="token operator">:</span> <span class="token punctuation">{</span>
      on<span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token constant">TOGGLE</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          target<span class="token operator">:</span> <span class="token string">'active'</span><span class="token punctuation">,</span>
          <span class="token comment">// 再次向服务发送 TOGGLE 事件</span>
          actions<span class="token operator">:</span> <span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'TOGGLE'</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    active<span class="token operator">:</span> <span class="token punctuation">{</span>
      on<span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token constant">TOGGLE</span><span class="token operator">:</span> <span class="token punctuation">{</span> target<span class="token operator">:</span> <span class="token string">'inactive'</span> <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> nextState <span class="token operator">=</span> lazyStubbornMachine<span class="token punctuation">.</span><span class="token function">transition</span><span class="token punctuation">(</span><span class="token string">'inactive'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  type<span class="token operator">:</span> <span class="token string">'TOGGLE'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

nextState<span class="token punctuation">.</span>value<span class="token punctuation">;</span>
<span class="token comment">// =&gt; 'active'</span>
nextState<span class="token punctuation">.</span>actions<span class="token punctuation">;</span>
<span class="token comment">// =&gt; [{ type: 'xstate.send', event: { type: 'TOGGLE' }}]</span>

<span class="token comment">// 该服务将继续向自己发送 { type: 'TOGGLE' } 事件。</span>
</code></pre></div><p>传递给 <code>send(event)</code> 的 <code>event</code> 参数可以是：</p> <ul><li>一个字符串事件，例如 <code>send('TOGGLE')</code></li> <li>一个对象事件，例如 <code>send({ type: 'TOGGLE', payload: ... })</code></li> <li>一个事件表达式，它是一个函数，它接收触发 <code>send()</code> 动作 的当前 <code>context</code> 和 <code>event</code>，并返回一个事件对象：</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> send <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'xstate'</span><span class="token punctuation">;</span>

<span class="token comment">// 人为的例子 - 从 `context` 读取并发送动态创建的事件</span>
<span class="token keyword">const</span> sendName <span class="token operator">=</span> <span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">context<span class="token punctuation">,</span> event</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
  type<span class="token operator">:</span> <span class="token string">'NAME'</span><span class="token punctuation">,</span>
  name<span class="token operator">:</span> context<span class="token punctuation">.</span>user<span class="token punctuation">.</span>name
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> machine <span class="token operator">=</span> <span class="token function">createMachine</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
  on<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token constant">TOGGLE</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      actions<span class="token operator">:</span> sendName
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token comment">//...</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="发送目标"><a href="#发送目标" class="header-anchor">#</a> 发送目标</h3> <p>从 <code>send(...)</code> 动作 创建者发送的事件，可以表示它应该发送到特定目标，例如 <a href="/docs/zh/guides/communication.html">调用 服务</a> 或 <a href="/docs/zh/guides/actors.html">创建 演员</a>。 这是通过在 <code>send(...)</code> 操作中指定 <code>{ to: ... }</code> 属性来完成的：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// ...</span>
invoke<span class="token operator">:</span> <span class="token punctuation">{</span>
  id<span class="token operator">:</span> <span class="token string">'some-service-id'</span><span class="token punctuation">,</span>
  src<span class="token operator">:</span> <span class="token string">'someService'</span><span class="token punctuation">,</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token comment">// ...</span>
<span class="token comment">// 表示向调用的服务发送 { type: 'SOME_EVENT' }</span>
actions<span class="token operator">:</span> <span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">{</span> type<span class="token operator">:</span> <span class="token string">'SOME_EVENT'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> to<span class="token operator">:</span> <span class="token string">'some-service-id'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p><code>to</code> 属性中的 target 也可以是一个 <strong>target 表达式</strong>，它是一个函数，它接受当前触发动作的 <code>context</code> 和 <code>event</code>，并返回一个字符串 target 或一个 <a href="/docs/zh/guides/actors.html#spawning-actors">演员</a>:</p> <div class="language-js extra-class"><pre class="language-js"><code>entry<span class="token operator">:</span> <span class="token function">assign</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token function-variable function">someActor</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">spawn</span><span class="token punctuation">(</span>someMachine<span class="token punctuation">,</span> <span class="token string">'some-actor-name'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token comment">// ...</span>

  <span class="token comment">// 发送 { type: 'SOME_EVENT' } 到 演员 引用</span>
  <span class="token punctuation">{</span>
    actions<span class="token operator">:</span> <span class="token function">send</span><span class="token punctuation">(</span>
      <span class="token punctuation">{</span> type<span class="token operator">:</span> <span class="token string">'SOME_EVENT'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token function-variable function">to</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">context</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> context<span class="token punctuation">.</span>someActor
      <span class="token punctuation">}</span>
    <span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><div class="custom-block warning"><p class="custom-block-title">注意</p> <p>同样，<code>send(...)</code> 函数是一个 动作 创建者，<strong>不会命令式发送事件。</strong> 相反，它返回一个 动作 对象，描述事件将发送到的位置：</p> <div class="language-js extra-class"><pre class="language-js"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">{</span> type<span class="token operator">:</span> <span class="token string">'SOME_EVENT'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> to<span class="token operator">:</span> <span class="token string">'child'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// logs:</span>
<span class="token comment">// {</span>
<span class="token comment">//   type: 'xstate.send',</span>
<span class="token comment">//   to: 'child',</span>
<span class="token comment">//   event: {</span>
<span class="token comment">//     type: 'SOME_EVENT'</span>
<span class="token comment">//   }</span>
<span class="token comment">// }</span>
</code></pre></div></div> <p>要从子状态机发送到父状态机，请使用 <code>sendParent(event)</code>（采用与 <code>send(...)</code> 相同的参数）。</p> <h2 id="升高动作-raise-action"><a href="#升高动作-raise-action" class="header-anchor">#</a> 升高动作（raise action）</h2> <p><code>raise()</code> 动作 创建者在内部事件队列中，将一个事件排入状态图。 这意味着事件会在 解释（interpret） 的当前“步骤”上立即发送。</p> <table><thead><tr><th>参数</th> <th>类型</th> <th>描述</th></tr></thead> <tbody><tr><td><code>event</code></td> <td>string or event object</td> <td>要提升的事件</td></tr></tbody></table> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> createMachine<span class="token punctuation">,</span> actions <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'xstate'</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> raise <span class="token punctuation">}</span> <span class="token operator">=</span> actions<span class="token punctuation">;</span>

<span class="token keyword">const</span> raiseActionDemo <span class="token operator">=</span> <span class="token function">createMachine</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  id<span class="token operator">:</span> <span class="token string">'raisedmo'</span><span class="token punctuation">,</span>
  initial<span class="token operator">:</span> <span class="token string">'entry'</span><span class="token punctuation">,</span>
  states<span class="token operator">:</span> <span class="token punctuation">{</span>
    entry<span class="token operator">:</span> <span class="token punctuation">{</span>
      on<span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token constant">STEP</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          target<span class="token operator">:</span> <span class="token string">'middle'</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token constant">RAISE</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          target<span class="token operator">:</span> <span class="token string">'middle'</span><span class="token punctuation">,</span>
          <span class="token comment">// 立即为“middle”调用 NEXT 事件</span>
          actions<span class="token operator">:</span> <span class="token function">raise</span><span class="token punctuation">(</span><span class="token string">'NEXT'</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    middle<span class="token operator">:</span> <span class="token punctuation">{</span>
      on<span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token constant">NEXT</span><span class="token operator">:</span> <span class="token punctuation">{</span> target<span class="token operator">:</span> <span class="token string">'last'</span> <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    last<span class="token operator">:</span> <span class="token punctuation">{</span>
      on<span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token constant">RESET</span><span class="token operator">:</span> <span class="token punctuation">{</span> target<span class="token operator">:</span> <span class="token string">'entry'</span> <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>单击 <a href="https://stately.ai/viz?gist=fd763ff2c161b172f719891e2544d428" target="_blank" rel="noopener noreferrer">visualizer<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 中的“STEP”和“RAISE”事件以查看差异。</p> <h2 id="响应动作-respond-action"><a href="#响应动作-respond-action" class="header-anchor">#</a> 响应动作 （respond action） <span class="badge tip" style="vertical-align:top;" data-v-15b7b770>4.7+</span></h2> <p><code>respond()</code> 动作 创建者创建一个 <a href="#send-action"><code>send()</code> 动作</a>，该 动作 被发送到，触发响应的事件的服务。</p> <p>这在内部使用 <a href="/docs/zh/guides/scxml.html#events">SCXML 事件</a> ，从事件中获取 <code>origin</code>，并将 <code>send()</code> 动作 的 <code>to</code> 设置为 <code>origin</code>。</p> <table><thead><tr><th>参数</th> <th>类型</th> <th>描述</th></tr></thead> <tbody><tr><td><code>event</code></td> <td>string, event object, or send expression</td> <td>发送回发件人的事件</td></tr> <tr><td><code>options?</code></td> <td>send options object</td> <td>传递到 <code>send()</code> 事件的选项</td></tr></tbody></table> <h3 id="使用响应-action-的示例"><a href="#使用响应-action-的示例" class="header-anchor">#</a> 使用响应 action 的示例</h3> <p>这演示了一些父服务（<code>authClientMachine</code>）向调用的 <code>authServerMachine</code> 发送一个 <code>'CODE'</code> 事件，并且 <code>authServerMachine</code> 响应一个 <code>'TOKEN'</code> 事件。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> authServerMachine <span class="token operator">=</span> <span class="token function">createMachine</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  initial<span class="token operator">:</span> <span class="token string">'waitingForCode'</span><span class="token punctuation">,</span>
  states<span class="token operator">:</span> <span class="token punctuation">{</span>
    waitingForCode<span class="token operator">:</span> <span class="token punctuation">{</span>
      on<span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token constant">CODE</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          actions<span class="token operator">:</span> <span class="token function">respond</span><span class="token punctuation">(</span><span class="token punctuation">{</span> type<span class="token operator">:</span> <span class="token string">'TOKEN'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> delay<span class="token operator">:</span> <span class="token number">10</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> authClientMachine <span class="token operator">=</span> <span class="token function">createMachine</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  initial<span class="token operator">:</span> <span class="token string">'idle'</span><span class="token punctuation">,</span>
  states<span class="token operator">:</span> <span class="token punctuation">{</span>
    idle<span class="token operator">:</span> <span class="token punctuation">{</span>
      on<span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token constant">AUTH</span><span class="token operator">:</span> <span class="token punctuation">{</span> target<span class="token operator">:</span> <span class="token string">'authorizing'</span> <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    authorizing<span class="token operator">:</span> <span class="token punctuation">{</span>
      invoke<span class="token operator">:</span> <span class="token punctuation">{</span>
        id<span class="token operator">:</span> <span class="token string">'auth-server'</span><span class="token punctuation">,</span>
        src<span class="token operator">:</span> authServerMachine
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      entry<span class="token operator">:</span> <span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'CODE'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> to<span class="token operator">:</span> <span class="token string">'auth-server'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      on<span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token constant">TOKEN</span><span class="token operator">:</span> <span class="token punctuation">{</span> target<span class="token operator">:</span> <span class="token string">'authorized'</span> <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    authorized<span class="token operator">:</span> <span class="token punctuation">{</span>
      type<span class="token operator">:</span> <span class="token string">'final'</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>详情请参阅 <a href="/docs/zh/guides/actors.html#sending-responses">📖 发送响应</a>。</p> <h2 id="转发动作-forwardto-action"><a href="#转发动作-forwardto-action" class="header-anchor">#</a> 转发动作（forwardTo action） <span class="badge tip" style="vertical-align:top;" data-v-15b7b770>4.7+</span></h2> <p><code>forwardTo()</code> 动作 创建者，创建一个 <a href="#send-action"><code>send()</code> 动作</a>，通过其 ID 将最近的事件转发到指定的服务。</p> <table><thead><tr><th>参数</th> <th>类型</th> <th>描述</th></tr></thead> <tbody><tr><td><code>target</code></td> <td>string or function that returns service</td> <td>要将最近事件发送到的目标服务。</td></tr></tbody></table> <h3 id="使用-forwardto-动作-的示例"><a href="#使用-forwardto-动作-的示例" class="header-anchor">#</a> 使用 forwardTo 动作 的示例</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> createMachine<span class="token punctuation">,</span> forwardTo<span class="token punctuation">,</span> interpret <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'xstate'</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">alertService</span><span class="token punctuation">(</span><span class="token parameter">_<span class="token punctuation">,</span> receive</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">receive</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>event<span class="token punctuation">.</span>type <span class="token operator">===</span> <span class="token string">'ALERT'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">alert</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> parentMachine <span class="token operator">=</span> <span class="token function">createMachine</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  id<span class="token operator">:</span> <span class="token string">'parent'</span><span class="token punctuation">,</span>
  invoke<span class="token operator">:</span> <span class="token punctuation">{</span>
    id<span class="token operator">:</span> <span class="token string">'alerter'</span><span class="token punctuation">,</span>
    <span class="token function-variable function">src</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> alertService
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  on<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token constant">ALERT</span><span class="token operator">:</span> <span class="token punctuation">{</span> actions<span class="token operator">:</span> <span class="token function">forwardTo</span><span class="token punctuation">(</span><span class="token string">'alerter'</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> parentService <span class="token operator">=</span> <span class="token function">interpret</span><span class="token punctuation">(</span>parentMachine<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

parentService<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">{</span> type<span class="token operator">:</span> <span class="token string">'ALERT'</span><span class="token punctuation">,</span> message<span class="token operator">:</span> <span class="token string">'hello world'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// =&gt; alerts &quot;hello world&quot;</span>
</code></pre></div><h2 id="错误升级动作-escalate-action"><a href="#错误升级动作-escalate-action" class="header-anchor">#</a> 错误升级动作（escalate action） <span class="badge tip" style="vertical-align:top;" data-v-15b7b770>4.7+</span></h2> <p><code>escalate()</code> 动作 创建者，通过将错误发送到父状态机来升级错误。 这是作为状态机识别的特殊错误事件发送的。</p> <table><thead><tr><th>参数</th> <th>类型</th> <th>描述</th></tr></thead> <tbody><tr><td><code>errorData</code></td> <td>any</td> <td>要升高（send）到父级的错误数据。</td></tr></tbody></table> <h3 id="使用-escalate-动作-的示例"><a href="#使用-escalate-动作-的示例" class="header-anchor">#</a> 使用 escalate 动作 的示例</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> createMachine<span class="token punctuation">,</span> actions <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'xstate'</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> escalate <span class="token punctuation">}</span> <span class="token operator">=</span> actions<span class="token punctuation">;</span>

<span class="token keyword">const</span> childMachine <span class="token operator">=</span> <span class="token function">createMachine</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
  <span class="token comment">// 这将被发送到调用这个孩子的父状态机</span>
  entry<span class="token operator">:</span> <span class="token function">escalate</span><span class="token punctuation">(</span><span class="token punctuation">{</span> message<span class="token operator">:</span> <span class="token string">'This is some error'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> parentMachine <span class="token operator">=</span> <span class="token function">createMachine</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
  invoke<span class="token operator">:</span> <span class="token punctuation">{</span>
    src<span class="token operator">:</span> childMachine<span class="token punctuation">,</span>
    onError<span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token function-variable function">actions</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">context<span class="token punctuation">,</span> event</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//  {</span>
        <span class="token comment">//    type: ...,</span>
        <span class="token comment">//    data: {</span>
        <span class="token comment">//      message: 'This is some error'</span>
        <span class="token comment">//    }</span>
        <span class="token comment">//  }</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="日志动作-log-action"><a href="#日志动作-log-action" class="header-anchor">#</a> 日志动作（log action）</h2> <p><code>log()</code> 动作 创建器是一种记录与当前状态 <code>context</code> 和/或 <code>event</code> 相关的任何内容的声明方式。 它需要两个可选参数：</p> <table><thead><tr><th>参数</th> <th>类型</th> <th>描述</th></tr></thead> <tbody><tr><td><code>expr?</code></td> <td>string or function</td> <td>一个简单的字符串或一个函数，它以 <code>context</code> 和 <code>event</code> 作为参数并返回一个要记录的值</td></tr> <tr><td><code>label?</code></td> <td>string</td> <td>用于标记已记录消息的字符串</td></tr></tbody></table> <div class="language-js extra-class"><div class="highlight-lines"><br><br><br><br><br><br><br><br><div class="highlighted"> </div><br><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><br><br><br><br><br><br><br><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><br><br><br></div><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> createMachine<span class="token punctuation">,</span> actions <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'xstate'</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> log <span class="token punctuation">}</span> <span class="token operator">=</span> actions<span class="token punctuation">;</span>

<span class="token keyword">const</span> loggingMachine <span class="token operator">=</span> <span class="token function">createMachine</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  id<span class="token operator">:</span> <span class="token string">'logging'</span><span class="token punctuation">,</span>
  context<span class="token operator">:</span> <span class="token punctuation">{</span> count<span class="token operator">:</span> <span class="token number">42</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  initial<span class="token operator">:</span> <span class="token string">'start'</span><span class="token punctuation">,</span>
  states<span class="token operator">:</span> <span class="token punctuation">{</span>
    start<span class="token operator">:</span> <span class="token punctuation">{</span>
      entry<span class="token operator">:</span> <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'started!'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      on<span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token constant">FINISH</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          target<span class="token operator">:</span> <span class="token string">'end'</span><span class="token punctuation">,</span>
          actions<span class="token operator">:</span> <span class="token function">log</span><span class="token punctuation">(</span>
            <span class="token punctuation">(</span><span class="token parameter">context<span class="token punctuation">,</span> event</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">count: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>context<span class="token punctuation">.</span>count<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">, event: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>event<span class="token punctuation">.</span>type<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
            <span class="token string">'Finish label'</span>
          <span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    end<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> endState <span class="token operator">=</span> loggingMachine<span class="token punctuation">.</span><span class="token function">transition</span><span class="token punctuation">(</span><span class="token string">'start'</span><span class="token punctuation">,</span> <span class="token string">'FINISH'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

endState<span class="token punctuation">.</span>actions<span class="token punctuation">;</span>
<span class="token comment">// [</span>
<span class="token comment">//   {</span>
<span class="token comment">//     type: 'xstate.log',</span>
<span class="token comment">//     label: 'Finish label',</span>
<span class="token comment">//     expr: (context, event) =&gt; ...</span>
<span class="token comment">//   }</span>
<span class="token comment">// ]</span>

<span class="token comment">// interpreter 将根据当前状态上下文和事件记录 Action 的表达式。</span>
</code></pre></div><p>没有任何参数，<code>log()</code> 是一个 动作，它记录一个具有 <code>context</code> 和 <code>event</code> 属性的对象，分别包含当前上下文和触发事件。</p> <h2 id="选择动作-choose-action"><a href="#选择动作-choose-action" class="header-anchor">#</a> 选择动作（choose action）</h2> <p><code>choose()</code> 动作 创建者创建一个 动作，该 动作 指定应根据某些条件执行哪些 动作。</p> <table><thead><tr><th>参数</th> <th>类型</th> <th>描述</th></tr></thead> <tbody><tr><td><code>conds</code></td> <td>array</td> <td>当给定的 <code>cond</code> 为真时，包含要执行的 <code>actions</code> 的对象数组（见下文）</td></tr></tbody></table> <p><strong>返回:</strong></p> <p>一个特殊的 <code>&quot;xstate.choose&quot;</code> 动作 对象，它在内部进行判断以有条件地确定应该执行哪些动作对象。</p> <p><code>cond</code> 中的每个“条件动作”对象都具有以下属性：</p> <ul><li><code>actions</code> - 要执行的 动作 对象</li> <li><code>cond?</code> - 执行这些 <code>actions</code> 的条件</li></ul> <div class="custom-block warning"><p class="custom-block-title">注意</p> <p>不要使用 <code>choose()</code> 动作 创建器来执行 动作，否则这些 动作 可能表示为通过 <code>entry</code>、<code>exit</code> 或 <code>actions</code> 在某些 状态/转换 中执行的非条件 动作。</p></div> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> actions <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'xstate'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token punctuation">{</span> choose<span class="token punctuation">,</span> log <span class="token punctuation">}</span> <span class="token operator">=</span> actions<span class="token punctuation">;</span>

<span class="token keyword">const</span> maybeDoThese <span class="token operator">=</span> <span class="token function">choose</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    cond<span class="token operator">:</span> <span class="token string">'cond1'</span><span class="token punctuation">,</span>
    actions<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token comment">// 当“cond1”为真时</span>
      <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'cond1 chosen!'</span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    cond<span class="token operator">:</span> <span class="token string">'cond2'</span><span class="token punctuation">,</span>
    actions<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token comment">// 当“cond1”为假且“cond2”为真时</span>
      <span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">context<span class="token punctuation">,</span> event</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token comment">/* ... */</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'another action'</span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token function-variable function">cond</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">context<span class="token punctuation">,</span> event</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token comment">// 一些条件</span>
      <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    actions<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token comment">// 当“cond1”和“cond2”为假并且内联`cond`为真时</span>
      <span class="token punctuation">(</span><span class="token parameter">context<span class="token punctuation">,</span> event</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token comment">// 一些其他 action</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    actions<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'fall-through action'</span><span class="token punctuation">)</span>
      <span class="token comment">// 当“cond1”、“cond2”和“cond3”为假时</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>这类似于 SCXML <code>&lt;if&gt;</code>、<code>&lt;elseif&gt;</code> 和 <code>&lt;else&gt;</code> 元素： <a href="https://www.w3.org/TR/scxml/#if" target="_blank" rel="noopener noreferrer">www.w3.org/TR/scxml/#if<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="纯动作-pure-action"><a href="#纯动作-pure-action" class="header-anchor">#</a> 纯动作（pure action）</h2> <p><code>pure()</code> 动作 创建器是一个纯函数（因此得名），它根据触发 动作 的当前状态“上下文”和“事件”返回要执行的 动作 对象。 这允许你动态定义应执行哪些 动作</p> <table><thead><tr><th>参数</th> <th>类型</th> <th>描述</th></tr></thead> <tbody><tr><td><code>getActions</code></td> <td>function</td> <td>根据给定的 <code>context</code> 和 <code>event</code> 返回要执行的动作对象的函数（见下文）</td></tr></tbody></table> <p><strong>返回:</strong></p> <p>一个特殊的 <code>&quot;xstate.pure&quot;</code> 动作 对象，它将在内部判断 <code>get</code> 属性以确定应该执行的 动作 对象。</p> <p><code>getActions(context, event)</code> 参数:</p> <table><thead><tr><th>参数</th> <th>类型</th> <th>描述</th></tr></thead> <tbody><tr><td><code>context</code></td> <td>object</td> <td>当前状态的 <code>context</code></td></tr> <tr><td><code>event</code></td> <td>event object</td> <td>触发 动作 的事件对象</td></tr></tbody></table> <p><strong>返回:</strong></p> <p>单个 动作 对象、一组 动作 对象或不代表任何 动作 对象的 <code>undefined</code>。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> createMachine<span class="token punctuation">,</span> actions <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'xstate'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token punctuation">{</span> pure <span class="token punctuation">}</span> <span class="token operator">=</span> actions<span class="token punctuation">;</span>

<span class="token comment">// 动态地向每个调用的示例 actor 发送一个事件</span>
<span class="token keyword">const</span> sendToAllSampleActors <span class="token operator">=</span> <span class="token function">pure</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">context<span class="token punctuation">,</span> event</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> context<span class="token punctuation">.</span>sampleActors<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">sampleActor</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'SOME_EVENT'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> to<span class="token operator">:</span> sampleActor <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// =&gt; {</span>
<span class="token comment">//   type: ActionTypes.Pure,</span>
<span class="token comment">//   get: () =&gt; ... // 计算为 send() action 数组</span>
<span class="token comment">// }</span>

<span class="token keyword">const</span> machine <span class="token operator">=</span> <span class="token function">createMachine</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
  states<span class="token operator">:</span> <span class="token punctuation">{</span>
    active<span class="token operator">:</span> <span class="token punctuation">{</span>
      entry<span class="token operator">:</span> sendToAllSampleActors
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="自转换动作"><a href="#自转换动作" class="header-anchor">#</a> 自转换动作</h2> <p><a href="/docs/zh/guides/transitions.html#self-transitions">自转换</a> 是当状态转换到自身时，它 <em>可能</em> 退出然后重新进入自身。 自转换可以是 <strong>内部</strong> 或 <strong>外部</strong> 转换：</p> <ul><li>内部转换将 <em>不</em> 退出并重新进入自身，因此状态节点的“进入”和“退出”动作将不会再次执行。
<ul><li>内部转换用 <code>{ internal: true }</code> 表示，或者将 <code>target</code> 保留为 <code>undefined</code>。</li> <li>将执行在转换的 <code>actions</code> 属性上定义的 动作。</li></ul></li> <li>外部转换 <em>将</em> 退出并重新进入自身，因此状态节点的<code>entry</code> 和<code>exit</code> action 将再次执行。
<ul><li>默认情况下，所有转换都是外部的。 为了明确起见，你可以使用 <code>{ internal: false }</code> 来指示它们。</li> <li>将执行在转换的 <code>actions</code> 属性上定义的 动作。</li></ul></li></ul> <p>例如，这个计数器状态机，有一个带有内部和外部转换的 <code>'counting'</code> 状态：</p> <div class="language-js extra-class"><div class="highlight-lines"><br><br><br><br><br><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br></div><pre class="language-js"><code><span class="token keyword">const</span> counterMachine <span class="token operator">=</span> <span class="token function">createMachine</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  id<span class="token operator">:</span> <span class="token string">'counter'</span><span class="token punctuation">,</span>
  initial<span class="token operator">:</span> <span class="token string">'counting'</span><span class="token punctuation">,</span>
  states<span class="token operator">:</span> <span class="token punctuation">{</span>
    counting<span class="token operator">:</span> <span class="token punctuation">{</span>
      entry<span class="token operator">:</span> <span class="token string">'enterCounting'</span><span class="token punctuation">,</span>
      exit<span class="token operator">:</span> <span class="token string">'exitCounting'</span><span class="token punctuation">,</span>
      on<span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token comment">// 自转换</span>
        <span class="token constant">INC</span><span class="token operator">:</span> <span class="token punctuation">{</span> actions<span class="token operator">:</span> <span class="token string">'increment'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">// 内部（隐式）</span>
        <span class="token constant">DEC</span><span class="token operator">:</span> <span class="token punctuation">{</span> target<span class="token operator">:</span> <span class="token string">'counting'</span><span class="token punctuation">,</span> actions<span class="token operator">:</span> <span class="token string">'decrement'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">// 外部</span>
        <span class="token constant">DO_NOTHING</span><span class="token operator">:</span> <span class="token punctuation">{</span> internal<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> actions<span class="token operator">:</span> <span class="token string">'logNothing'</span> <span class="token punctuation">}</span> <span class="token comment">// 内部（隐式）</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 外部转换（退出+ 转换action +进入）</span>
<span class="token keyword">const</span> stateA <span class="token operator">=</span> counterMachine<span class="token punctuation">.</span><span class="token function">transition</span><span class="token punctuation">(</span><span class="token string">'counting'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> type<span class="token operator">:</span> <span class="token string">'DEC'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
stateA<span class="token punctuation">.</span>actions<span class="token punctuation">;</span>
<span class="token comment">// ['exitCounting', 'decrement', 'enterCounting']</span>

<span class="token comment">// 内部转换（转换动作）</span>
<span class="token keyword">const</span> stateB <span class="token operator">=</span> counterMachine<span class="token punctuation">.</span><span class="token function">transition</span><span class="token punctuation">(</span><span class="token string">'counting'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> type<span class="token operator">:</span> <span class="token string">'DO_NOTHING'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
stateB<span class="token punctuation">.</span>actions<span class="token punctuation">;</span>
<span class="token comment">// ['logNothing']</span>

<span class="token keyword">const</span> stateC <span class="token operator">=</span> counterMachine<span class="token punctuation">.</span><span class="token function">transition</span><span class="token punctuation">(</span><span class="token string">'counting'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> type<span class="token operator">:</span> <span class="token string">'INC'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
stateB<span class="token punctuation">.</span>actions<span class="token punctuation">;</span>
<span class="token comment">// ['increment']</span>
</code></pre></div></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/davidkpiano/xstate/edit/main/docs/zh/guides/actions.md" target="_blank" rel="noopener noreferrer">在 GitHub 上编辑此页</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2022/3/1 17:36:57</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/docs/zh/guides/effects.html" class="prev">
        作用 Effects
      </a></span> <span class="next"><a href="/docs/zh/guides/guards.html">
        守卫（Guarded）转换
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/docs/assets/js/app.9ff62a46.js" defer></script><script src="/docs/assets/js/3.2a139785.js" defer></script><script src="/docs/assets/js/9.47fde1b3.js" defer></script><script src="/docs/assets/js/94.4ee7fb06.js" defer></script><script src="/docs/assets/js/10.f0e23b4a.js" defer></script>
  </body>
</html>
